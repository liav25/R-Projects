library(dplyr)
library(ggplot2)
library(GGally)
library(olsrr)
library(gmodels)
library(dummies)
library(MASS)


path = "C:\\Users\\Liav\\Desktop\\Uni\\Dropbox\\Project_JIM"
setwd(path)
data = read.csv('leaders_data.csv')[1:62,]

desc = function(inpvar, vname) {
  n = sum(!is.na(inpvar))
  sumry = summary(inpvar)
  std =  sd(inpvar, na.rm=T)
  range = max(inpvar) - min(inpvar)
  iqr = IQR(inpvar, na.rm=T)
  prbs = seq(0.05, 0.95, 0.05)
  prbs = c(0.01, prbs, 0.99)
  quant = quantile(inpvar, probs=prbs, na.rm=T)
  ans = list(n=n, sumry=sumry, std=std, range=range, iqr=iqr, quant=quant)
  hist(inpvar, breaks="Scott", freq=F, main = paste("Histogram of" , vname), xlab=vname)
  return(ans)
}  

desc = function(inpvar, vname) {
  n = sum(!is.na(inpvar))
  sumry = summary(inpvar)
  std =  sd(inpvar, na.rm=T)
  range = max(inpvar) - min(inpvar)
  iqr = IQR(inpvar, na.rm=T)
  prbs = seq(0.05, 0.95, 0.05)
  prbs = c(0.01, prbs, 0.99)
  quant = quantile(inpvar, probs=prbs, na.rm=T)
  ans = list(n=n, sumry=sumry, std=std, range=range, iqr=iqr, quant=quant)
  hist(inpvar, main = paste("Histogram of" , vname), xlab=vname)
  return(ans)
}  
# 1. descriptive stats for continuous variables
desc(as.integer(data$tweets_downloaded),'tweets_downloaded')
desc(data$happiness_score,'happiness_score')
desc(data$GDP_per_capita,'GDP_per_capita')
desc(data$Healthy.life.expectancy,'Healthy.life.expectancy')
desc(data$Freedom.to.make.life.choices,'Freedom.to.make.life.choices')
desc(data$Generosity,'Generosity')
desc(data$Perceptions.of.corruption,'Perceptions.of.corruption')
desc(as.integer(data$population),'population')
desc(as.integer(data$GINI),'GINI')
desc(data$hofstede_idv, 'idv')
desc(data$hofstede_pdi, 'pdi')
desc(data$hofstede_ivr, 'ivr')
desc(data$hofstede_ltowvs, 'ltowvs')
desc(data$hofstede_uai, 'uai')
desc(data$hofstede_mas, 'mas')


# 2+3+4. correlations between Y and continuous variables and Scatterplots

contin.dat = data[,c(11:18,22:28,30,32:39)]
freedom.dat = data[,c(11:18,36)]
hofstede = data[,c(22:28,36)]
ggscatmat(hofstede)
ggscatmat(freedom.dat)
ggscatmat(data[,32:39])
#age*monthes in position interaction
ggscatmat(cbind(data$age*data$months_in_position, data$polarity))


# 5. Frequency table for categorical variables

categor.dat = data[,c(2,18:20,28,)]
for (i in 1:length(categor.dat)){
  print(colnames(categor.dat)[i])
  print(table(categor.dat[,i]))
}

# 6. In case there is more than one categorical variable, cross tables should be included:
#heatmaps of categorial vairable
# 7. Boxplots of Y and the continuous X variables by value of each categorical variable



data = data[,-c(1,3,4,5,6,8,9,10,20,31,33,40)]

plot(data)

data = data[,-c(24,26)]
colnames(data)
