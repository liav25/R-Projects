library(dplyr)
library(ggplot2)
library(GGally)
library(olsrr)
library(gmodels)
library(dummies)
library(MASS)

library(corrplot)

path = "C:\\Users\\Liav\\Desktop\\Uni\\Dropbox\\Project_JIM"
setwd(path)
data = read.csv('leaders_data.csv')[-c(10,63),]

#make precentage and diff
data$ME = data$ME *100
data$WE = data$WE * 100
data$diff = data$ME - data$WE

desc = function(inpvar, vname) {
  n = sum(!is.na(inpvar))
  sumry = summary(inpvar)
  std =  sd(inpvar, na.rm=T)
  range = max(inpvar) - min(inpvar)
  iqr = IQR(inpvar, na.rm=T)
  prbs = seq(0.05, 0.95, 0.05)
  prbs = c(0.01, prbs, 0.99)
  quant = quantile(inpvar, probs=prbs, na.rm=T)
  ans = list(n=n, sumry=sumry, std=std, range=range, iqr=iqr, quant=quant)
  hist(inpvar, breaks="Scott", freq=F, main = paste("Histogram of" , vname), xlab=vname)
  return(ans)
}  


# 1. descriptive stats for continuous variables
desc(as.integer(data$tweets_downloaded),'tweets_downloaded')
desc(data$happiness_score,'happiness_score')
desc(data$GDP_per_capita,'GDP_per_capita')
desc(data$Healthy.life.expectancy,'Healthy.life.expectancy')
desc(data$Freedom.to.make.life.choices,'Freedom.to.make.life.choices')
desc(data$Generosity,'Generosity')
desc(data$Perceptions.of.corruption,'Perceptions.of.corruption')
desc(as.integer(data$population),'population')
desc(as.integer(data$GINI),'GINI')
desc(data$hofstede_idv, 'idv')
desc(data$hofstede_pdi, 'pdi')
desc(data$hofstede_ivr, 'ivr')
desc(data$hofstede_ltowvs, 'ltowvs')
desc(data$hofstede_uai, 'uai')
desc(data$hofstede_mas, 'mas')

desc(data$sentiment, 'sent')
desc(data$abs_sentiment, 'abssent')
desc(data$abs_polarity, 'abspol')



# 2+3+4. correlations between Y and continuous variables and Scatterplots

contin.dat = data[,c(11:18,22:28,30,32:47)]
freedom.dat = data[,c(11:18,36)]
hofstede = data[,c(22:28,36)]
ggscatmat(hofstede)
ggscatmat(freedom.dat)
ggscatmat(data[,32:39])
#age*monthes in position interaction


contin.dat$population = as.numeric(contin.dat$population)
contin.dat$Followers_in_millions = as.numeric(contin.dat$Followers_in_millions)
contin.dat$Followers_per_capita = as.numeric(contin.dat$Followers_per_capita)

sapply(contin.dat, class)
cor.mat = cor(contin.dat,use = "complete.obs")
corrplot(cor.mat)

#write.csv(cor.mat,'corr_matrix.csv')



colnames(data)

datareg = data[,c(11:18,21,22:30,35:47)]


me_model = lm(data=datareg, formula = ME ~ hofstede_uai + hofstede_mas +
                hofstede_ltowvs + hofstede_idv + hofstede_ivr + hofstede_pdi)

summary(me_model)



we_model = lm(data=datareg, formula = ME ~ GDP)
summary(we_model) 

model$coefficients

